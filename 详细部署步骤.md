# 🚀 方式3：公网部署 - 超详细步骤

## 目标：让全世界都能访问 http://101.43.15.66/

---

## 📥 第一步：准备工具（5分钟）

### 1. 下载必需工具

**工具A：WinSCP（上传文件）**
```
下载地址：https://winscp.net/
作用：像FTP一样上传文件到服务器
选择：WinSCP最新版（免费）
```

**工具B：MobaXterm（SSH登录）**
```
下载地址：https://mobaxterm.mobatek.net/
作用：远程登录服务器执行命令
选择：Home版本（免费）
```

### 2. 下载后安装

双击安装包，一路"下一步"即可 ✅

---

## 🔐 第二步：连接服务器（5分钟）

### A. 使用WinSCP连接

1. **打开WinSCP**

2. **新建站点**
   - 点击"新建站点"
   - 协议：SFTP
   - 主机名：`101.43.15.66`
   - 端口：`22`
   - 用户名：`root`
   - 密码：`sx@123456`

3. **点击"登录"**
   - 首次连接会提示"主机密钥指纹"
   - 点击"是"继续

4. **连接成功后**
   - 左边：你的电脑
   - 右边：远程服务器

### B. 使用MobaXterm连接

1. **打开MobaXterm**

2. **新建SSH会话**
   - 点击"Session"
   - 选择"SSH"
   - 远程主机：`101.43.15.66`
   - 勾选"Specify username"
   - 用户名：`root`
   - 端口：`22`

3. **点击"OK"**
   - 输入密码：`sx@123456`
   - 勾选"保存密码"

4. **连接成功后**
   - 看到命令行界面
   - 显示：`root@xxx:~#`

---

## 📤 第三步：上传项目（10分钟）

### 1. 在WinSCP中操作

**左边的本地文件**：
```
找到：D:\Projects\ClaudeCode\topicgenerater
```

**右边的远程目录**：
```
导航到：/var/www/
如果不存在，右键"创建目录"输入：topic-generator
```

### 2. 上传文件

**方式A：拖拽上传**
```
选中左边所有文件 → 拖到右边 /var/www/topic-generator/
等待上传完成...
```

**方式B：右键上传**
```
选中 topic-generator 文件夹 → 右键
选择"上传"
目标：/var/www/
```

### 3. 上传完成后

应该能在服务器上看到：
```
/var/www/topic-generator/
├── web_server.py
├── run_web.py
├── src/
├── templates/
├── scripts/
└── ...
```

---

## ⚙️ 第四步：服务器配置（10分钟）

### 1. 在MobaXterm中执行命令

**复制粘贴以下命令**：

```bash
# 1. 进入项目目录
cd /var/www/topic-generator

# 2. 给脚本添加执行权限
chmod +x deploy.sh

# 3. 执行部署脚本
./deploy.sh
```

### 2. 部署脚本会自动完成

✅ 安装Python依赖
✅ 配置Nginx反向代理
✅ 创建系统服务
✅ 启动服务
✅ 设置开机自启

### 3. 看到成功提示

```
========================================
✅ 部署完成！
========================================

🌍 访问地址：http://101.43.15.66/
```

---

## 🌍 第五步：访问系统（立即）

### 1. 在任何设备上打开浏览器

**电脑**：
```
Chrome/Edge/Safari
输入：http://101.43.15.66/
```

**手机**：
```
Safari/Chrome
输入：http://101.43.15.66/
```

**平板**：
```
Safari/Chrome
输入：http://101.43.15.66/
```

### 2. 看到界面

```
🔥 热点抓取与爆文生成系统
统计卡片 + 操作按钮
```

### 3. 开始使用

点击"📥 开始抓取热点" ✅

---

## 🔧 服务器管理（日常使用）

### 查看服务状态

```bash
# 在MobaXterm中执行
sudo systemctl status topic-generator
```

**显示**：
```
● topic-generator.service - Topic Generator Web Service
   Loaded: loaded (/etc/systemd/system/topic-generator.service; enabled)
   Active: active (running) since ...
```

### 重启服务

```bash
sudo systemctl restart topic-generator
```

### 查看日志

```bash
# 实时查看日志
sudo journalctl -u topic-generator -f

# 查看最近50行
sudo journalctl -u topic-generator -n 50
```

### 停止服务

```bash
sudo systemctl stop topic-generator
```

---

## 🐛 常见问题解决

### 问题1：无法访问 http://101.43.15.66/

**原因**：防火墙/安全组未开放80端口

**解决A：腾讯云控制台**
```
1. 登录：https://console.cloud.tencent.com/
2. 进入：云服务器 → 安全组
3. 点击："配置规则" → "添加规则"
4. 填写：
   - 类型：自定义
   - 来源：0.0.0.0/0
   - 协议端口：TCP:80
   - 策略：允许
5. 点击"完成"
```

**解决B：服务器防火墙**
```bash
# 在MobaXterm中执行
sudo ufw allow 80
sudo ufw status
```

### 问题2：服务启动失败

**查看详细错误**：
```bash
sudo journalctl -u topic-generator -n 50 --no-pager
```

**常见错误1：端口被占用**
```bash
# 查看占用
sudo lsof -i:5000

# 杀死占用进程
sudo kill -9 <PID>
```

**常见错误2：Python模块缺失**
```bash
pip3 install flask flask-cors pymysql requests
```

**常见错误3：数据库连接失败**
```bash
# 测试数据库连接
python3 -c "from src.database.connection import test_connection; print(test_connection())"
```

### 问题3：页面显示不正常

**清除浏览器缓存**：
```
Chrome: Ctrl+Shift+Delete
Edge: Ctrl+Shift+Delete
Safari: Command+Option+E
```

**检查Nginx状态**：
```bash
sudo systemctl status nginx
sudo nginx -t
```

---

## 🎉 成功标志

部署成功后，你应该能：

✅ **在电脑上访问**
```
http://101.43.15.66/
```

✅ **在手机上访问**
```
http://101.43.15.66/
```

✅**在任何地方访问**
```
http://101.43.15.66/
```

✅ **看到界面**
```
🔥 热点抓取与爆文生成系统
统计卡片、操作按钮
```

✅ **功能正常**
```
点击"开始抓取" → 成功抓取
点击"生成爆文" → 成功生成
点击"查看历史" → 看到数据
```

---

## 📞 需要帮助？

如果遇到问题：

1. **查看日志**：`sudo journalctl -u topic-generator -f`
2. **检查服务**：`sudo systemctl status topic-generator`
3. **检查Nginx**：`sudo systemctl status nginx`
4. **查看部署指南**：`DEPLOYMENT_GUIDE.md`

---

**预估时间**：
- 下载工具：5分钟
- 连接服务器：5分钟
- 上传项目：10分钟
- 配置部署：10分钟
- **总计：30分钟**

**难度等级**：⭐⭐⭐（中等）

完成部署后，你的系统将24小时在线，全球可访问！🌍
